(function(a){a.fn.barousel=function(f){var h=a.extend({imageWrapper:".barousel_image",contentWrapper:".barousel_content",contentLinksWrapper:null,navWrapper:".barousel_nav",slideDuration:5000,navType:1,fadeIn:1,fadeInSpeed:600,manualCarousel:0,contentResize:1,contentResizeSpeed:300,debug:0},f||{});h.imageWrapper=a(this).find(h.imageWrapper);h.contentWrapper=a(this).find(h.contentWrapper);h.contentLinksWrapper=a(h.contentLinksWrapper);h.navWrapper=a(this).find(h.navWrapper);h.imageList=h.imageWrapper.find("img").not("[class*=intro]");h.contentList=h.contentWrapper.find("div").not("[class*=intro]");h.contentLinksList=h.contentLinksWrapper.find("a");h.imageIntro=h.imageWrapper.find("img[class*=intro]");h.contentIntro=h.contentWrapper.find("div[class*=intro]");h.currentIndex=1;h.totalItem=h.imageList.length;h.stopCarousel=0;h.timerCarousel;h.navFreeze=0;h.introActive=0;if(h.imageWrapper.find("img[class*=intro]").length>0){h.introActive=1}if(h.totalItem==1){}else{h.imageList.each(function(k){this.index=k});h.contentList.each(function(k){this.index=k});h.contentLinksList.each(function(k){this.index=k});if(h.imageList.length!=h.contentList.length){if(h.debug==1){console.log("[Barousel error] images and contents must be the same number")}return this}if(h.contentResize==1&&h.introActive==0){a(h.contentWrapper).height(a(h.contentList[h.currentIndex]).height()+10)}if(h.contentLinksWrapper!=null){a(h.contentLinksList[h.currentIndex]).addClass("current")}if(h.navType==1){var g="<ul>";h.imageList.each(function(l){var k="";if(l==0){k="current"}g+="<li><a href='#' title='"+a(h.contentList[l]).find("p.header").text()+"' class='"+k+"'>&nbsp;</a></li>"});g+="</ul>";h.navWrapper.append(g);h.navList=h.navWrapper.find("a");h.navList.each(function(k){this.index=k})}else{if(h.navType==2){var g="<ul>";g+="<li class='prev'><a href='#' title='previous'>&nbsp;</a></li>";g+="<li class='next'><a href='#' title='next'>&nbsp;</a></li>";g+="</ul><div class='counter'><span class='counter_current'>1</span>/<span class='counter_total'>"+h.totalItem+"</span></div>";h.navWrapper.append(g);h.navList=h.navWrapper.find("a")}else{if(h.navType==3){h.navList=h.navWrapper.find("a");h.navList.each(function(k){this.index=k})}}}if(h.navType==1||h.navType==3){h.navList.each(function(k){a(this).click(function(){if(h.navFreeze==0){window.clearTimeout(h.timerCarousel);h.stopCarousel=1;if(h.currentIndex!=k||h.introActive==1){d(h,k);h.currentIndex=k}}h.introActive=0;return false})})}else{if(h.navType==2){h.navList.each(function(){a(this).click(function(){if(h.navFreeze==0){window.clearTimeout(h.timerCarousel);h.stopCarousel=1;if(a(this).parent().hasClass("prev")){var l;if(parseInt(h.currentIndex)==0){l=parseInt(h.totalItem)-1}else{l=parseInt(h.currentIndex)-1}d(h,l);h.currentIndex=l}else{if(a(this).parent().hasClass("next")){var k;if(parseInt(h.currentIndex)==(parseInt(h.totalItem)-1)){k=0}else{k=parseInt(h.currentIndex)+1}d(h,k);h.currentIndex=k}}}h.introActive=0;return false})})}}if(h.manualCarousel==0){var e=function(){d(h,1)};h.timerCarousel=window.setTimeout(e,h.slideDuration)}}return this};var d=function(k,g){if(k.navType!=2){k.navList.each(function(m){a(this).removeClass("current")});a(k.navList[g]).addClass("current")}var l;if(k.introActive==1){l=a(k.imageIntro)}else{l=a(k.imageList[k.currentIndex])}var h=a(k.imageList[g]);if(k.debug==1){console.log("[Barousel loadItem] currentImage:"+l.attr("src"));console.log("[Barousel loadItem] nextImage:"+h.attr("src"))}if(!l.hasClass("default")){l.attr("class","previous")}h.attr("class","current");if(k.fadeIn==0){h.show();l.hide();b(k,g)}else{k.navFreeze=1;a(k.contentList).hide();h.fadeIn(k.fadeInSpeed,function(){l.hide();l.removeClass("previous");k.navFreeze=0});b(k,g)}if(k.stopCarousel==0){k.currentIndex=g;var f;if(k.currentIndex==k.totalItem-1){f=0}else{f=parseInt(k.currentIndex)+1}var e=function(){d(k,f)};k.timerCarousel=window.setTimeout(e,k.slideDuration)}};var b=function(f,e){if(f.introActive==1){a(f.contentIntro).hide();a(f.contentWrapper).attr("class","")}if(f.contentResize==1&&parseInt(a(f.contentWrapper).height())!=parseInt(a(f.contentList[e]).height()+10)){a(f.contentWrapper).animate({height:a(f.contentList[e]).height()+10},f.contentResizeSpeed,function(){c(f,e)})}else{c(f,e)}if(f.navType==2){a(f.navWrapper).find(".counter_current").text(e+1)}};var c=function(f,e){a(f.contentList).hide();a(f.contentList[e]).show();if(f.contentLinksWrapper!=null){a(f.contentLinksList).removeClass("current");a(f.contentLinksList[e]).addClass("current")}}})(jQuery);(function(f){f.fn.thslide=function(q,s){var r=f.extend({navPreviousWrapper:".thslide_nav_previous a",navNextWrapper:".thslide_nav_next a",listWrapper:".thslide_list ul",items:".thslide_list ul li a",itemOffset:100,itemVisible:5,slideSpeedSlow:600,slideSpeedFast:200,infiniteScroll:0,scrollOver:0,debug:0},q||{});r.navPreviousWrapper=f(this).find(r.navPreviousWrapper);r.navNextWrapper=f(this).find(r.navNextWrapper);r.listWrapper=f(this).find(r.listWrapper);r.items=f(this).find(r.items);r.totalItem=f(r.listWrapper).find("li").length;r.itemOffsetMax;r.listMarginLeft;r.slideSpeed;r.easing;r.locked=false;r.scrollOn=false;r.scrollTimer=0;r.navTimer;r.offsetStatus=0;r.offsetCurrent=3;r.manualCarousel=0;r.slideDuration=5000;r.autoSlid=false;r.wrapNum=r.itemVisible;r.wrapMid=r.offsetCurrent;if(r.totalItem<r.itemVisible){r.wrapNum=r.totalItem}if(r.totalItem==1){f(".thslide_nav_previous").hide();f(".thslide_nav_next").hide();return}if(r.manualCarousel==0){d(r)}if(r.totalItem<3){r.offsetCurrent=f(".thslide_item").length;r.wrapMid=r.offsetCurrent}if(s!=undefined){a(r,s)}l(r);r.itemOffsetMax=parseInt(f(r.listWrapper).find("li").length)*r.itemOffset-(r.itemVisible*r.itemOffset);r.itemOffsetMax=-parseInt(r.itemOffsetMax);r.items.click(function(t){t.preventDefault();id=f(this).attr("id");thecount=id.split("_");thecount=thecount[1];a(r,thecount);f("#screening_hidden_"+thecount).click();window.clearTimeout(r.timerCarousel);r.slideDuration=20000;d(r);return false});f(r.navPreviousWrapper).click(function(){window.clearTimeout(r.timerCarousel);r.slideDuration=20000;d(r);return false});f(r.navNextWrapper).click(function(){window.clearTimeout(r.timerCarousel);r.slideDuration=20000;d(r);return false});f(r.navPreviousWrapper).mousedown(function(){window.clearTimeout(r.timerCarousel);window.clearTimeout(r.navTimer);r.scrollOn=true;r.slideSpeed=r.slideSpeedFast;r.easing="swing";p();b(r)});f(r.navNextWrapper).mousedown(function(){window.clearTimeout(r.timerCarousel);window.clearTimeout(r.navTimer);r.scrollOn=true;r.slideSpeed=r.slideSpeedFast;r.easing="swing";p();c(r)});f(r.navPreviousWrapper).mouseup(function(){r.scrollOn=false;e(r);f("#screening_hidden_"+r.offsetCurrent).click()});f(r.navNextWrapper).mouseup(function(){r.scrollOn=false;e(r);f("#screening_hidden_"+r.offsetCurrent).click()});if(r.scrollOver==1){f(r.navPreviousWrapper).mouseover(function(){if(!r.scrollOn){r.scrollOn=true;r.slideSpeed=r.slideSpeedSlow;r.easing="linear";var t=function(){b(r)};r.navTimer=window.setTimeout(t,r.scrollTimer)}});f(r.navNextWrapper).mouseover(function(){if(!r.scrollOn){r.scrollOn=true;r.slideSpeed=r.slideSpeedSlow;r.easing="linear";var t=function(){c(r)};r.navTimer=window.setTimeout(t,r.scrollTimer)}});f(r.navPreviousWrapper).mouseout(function(){r.scrollOn=false;e(r);f("#screening_hidden_"+r.offsetCurrent).click()});f(r.navNextWrapper).mouseout(function(){r.scrollOn=false;e(r);f("#screening_hidden_"+r.offsetCurrent).click()})}return this};var b=function(q){if(!q.locked&&q.scrollOn&&((parseInt(q.listMarginLeft)+parseInt(q.itemOffset)<=0)||q.infiniteScroll==1)){if(q.offsetCount){if(q.offsetCount==q.offsetStatus){q.scrollOn=false;q.offsetStatus=0;q.offsetCount=null;e(q);return}q.offsetStatus+=1}if(q.offsetCurrent==1){q.offsetCurrent=q.totalItem}else{q.offsetCurrent-=1}q.locked=true;if(q.infiniteScroll==1){g(q,function(){o(q)})}else{o(q)}}};var o=function(r){var q=parseInt(r.listMarginLeft)+parseInt(r.itemOffset);if(r.debug==1){console.log("offsetUpdate: "+q)}f(r.listWrapper).animate({marginLeft:q},r.slideSpeed,r.easing,function(){if(r.infiniteScroll==0){l(r)}r.locked=false;if(r.scrollOn){r.easing="linear";b(r)}})};var c=function(r){if(!r.locked&&r.scrollOn&&(((parseInt(r.listMarginLeft)-parseInt(r.itemOffset))>=r.itemOffsetMax)||r.infiniteScroll==1)){if(r.offsetCount){if(r.offsetCount==r.offsetStatus){r.scrollOn=false;r.offsetStatus=0;r.offsetCount=null;e(r);return}r.offsetStatus+=1}if(r.offsetCurrent<r.totalItem){r.offsetCurrent+=1}else{r.offsetCurrent=1}r.locked=true;var q=-parseInt(r.itemOffset);if(r.debug==1){console.log("offsetUpdate: "+q)}f(r.listWrapper).animate({marginLeft:q},r.slideSpeed,r.easing,function(){if(r.infiniteScroll==0){l(r)}else{k(r,null)}r.locked=false;if(r.scrollOn){r.easing="linear";c(r)}})}};var h=function(r){for(var q=0;q<r.totalItem;q++){var s=parseInt(f(r.listWrapper).find("li").length-1)-parseInt(q);f(r.listWrapper).find("li:eq("+s+")").clone().insertBefore(f(r.listWrapper).find("li:first-child")).addClass("thslide_copy")}n(r)};var g=function(q,s){var r=f(q.listWrapper).find("li:last-child");f(q.listWrapper).find("li:first-child").before(r);f(q.listWrapper).css("marginLeft",-parseInt(q.itemOffset));l(q);if(typeof s=="function"){return s()}};var k=function(q,s){var r=f(q.listWrapper).find("li:first-child");f(q.listWrapper).find("li:last-child").after(r);f(q.listWrapper).css("marginLeft",0);l(q);if(typeof s=="function"){return s()}};var l=function(q){q.listMarginLeft=f(q.listWrapper).css("marginLeft").split("px")[0]};var n=function(q){f(q.listWrapper).css("marginLeft",-parseInt(q.itemOffset));l(q)};var p=function(){f(".thslide_item img").attr("class","ogcar_floatright other");f(".thslide_item span").attr("class","other")};var e=function(q){f("#screening_"+q.offsetCurrent+" img").attr("class","ogcar_floatright default");f("#screening_"+q.offsetCurrent+" span").attr("class","default")};var m=function(q){var t=f(".thslide_item img.default").parent().attr("id");if(!t){return}thecount=t.split("_");thecount=thecount[1];if(thecount==q.totalItem){thecount=0}var s=parseInt(thecount);var r=(s+1);a(q,r);f("#screening_hidden_"+r).click();if(q.manualCarousel==0){q.slideDuration=5000;d(q)}};var a=function(r,q){if(q==r.offsetCurrent){return}window.clearTimeout(r.navTimer);r.scrollOn=true;p();r.easing="swing";if(q>r.offsetCurrent){if((r.offsetCurrent<r.wrapMid)&&(q>(r.wrapNum+1))){var s=(parseInt(r.totalItem)+parseInt(r.offsetCurrent))-q;r.offsetCount=s;b(r)}else{r.offsetCount=q-r.offsetCurrent;c(r)}}if(q<r.offsetCurrent){if((r.offsetCurrent>(r.wrapNum+1))&&(q<r.wrapMid)){var s=(parseInt(q)+parseInt(r.totalItem))-parseInt(r.offsetCurrent);r.offsetCount=s;c(r)}else{var s=parseInt(r.offsetCurrent)-parseInt(q);r.offsetCount=s;b(r)}}};var d=function(r){var q=function(){m(r)};r.timerCarousel=window.setTimeout(q,r.slideDuration)}})(jQuery);(function(a){a.fn.jclock=function(c){var b="2.2.0";var d=a.extend({},a.fn.jclock.defaults,c);return this.each(function(){$this=a(this);$this.timerID=null;$this.running=false;$this.increment=0;$this.lastCalled=new Date().getTime();var e=a.meta?a.extend({},d,$this.data()):d;$this.format=e.format;$this.utc=e.utc;$this.utcOffset=(e.utc_offset!=null)?e.utc_offset:e.utcOffset;$this.seedTime=e.seedTime;$this.timeout=e.timeout;$this.css({fontFamily:e.fontFamily,fontSize:e.fontSize,backgroundColor:e.background,color:e.foreground});$this.daysAbbrvNames=new Array(7);$this.daysAbbrvNames[0]="Sun";$this.daysAbbrvNames[1]="Mon";$this.daysAbbrvNames[2]="Tue";$this.daysAbbrvNames[3]="Wed";$this.daysAbbrvNames[4]="Thu";$this.daysAbbrvNames[5]="Fri";$this.daysAbbrvNames[6]="Sat";$this.daysFullNames=new Array(7);$this.daysFullNames[0]="Sunday";$this.daysFullNames[1]="Monday";$this.daysFullNames[2]="Tuesday";$this.daysFullNames[3]="Wednesday";$this.daysFullNames[4]="Thursday";$this.daysFullNames[5]="Friday";$this.daysFullNames[6]="Saturday";$this.monthsAbbrvNames=new Array(12);$this.monthsAbbrvNames[0]="Jan";$this.monthsAbbrvNames[1]="Feb";$this.monthsAbbrvNames[2]="Mar";$this.monthsAbbrvNames[3]="Apr";$this.monthsAbbrvNames[4]="May";$this.monthsAbbrvNames[5]="Jun";$this.monthsAbbrvNames[6]="Jul";$this.monthsAbbrvNames[7]="Aug";$this.monthsAbbrvNames[8]="Sep";$this.monthsAbbrvNames[9]="Oct";$this.monthsAbbrvNames[10]="Nov";$this.monthsAbbrvNames[11]="Dec";$this.monthsFullNames=new Array(12);$this.monthsFullNames[0]="January";$this.monthsFullNames[1]="February";$this.monthsFullNames[2]="March";$this.monthsFullNames[3]="April";$this.monthsFullNames[4]="May";$this.monthsFullNames[5]="June";$this.monthsFullNames[6]="July";$this.monthsFullNames[7]="August";$this.monthsFullNames[8]="September";$this.monthsFullNames[9]="October";$this.monthsFullNames[10]="November";$this.monthsFullNames[11]="December";a.fn.jclock.startClock($this)})};a.fn.jclock.startClock=function(b){a.fn.jclock.stopClock(b);a.fn.jclock.displayTime(b)};a.fn.jclock.stopClock=function(b){if(b.running){clearTimeout(b.timerID)}b.running=false};a.fn.jclock.displayTime=function(b){var c=a.fn.jclock.getTime(b);b.html(c);b.timerID=setTimeout(function(){a.fn.jclock.displayTime(b)},b.timeout)};a.fn.jclock.getTime=function(c){if(typeof(c.seedTime)=="undefined"){var b=new Date()}else{c.increment+=new Date().getTime()-c.lastCalled;var b=new Date(c.seedTime+c.increment);c.lastCalled=new Date().getTime()}if(c.utc==true){var e=b.getTime();var l=b.getTimezoneOffset()*60000;var h=e+l;var m=h+(3600000*c.utcOffset);b=new Date(m)}var f="";var d=0;var g=0;while((g=c.format.indexOf("%",d))!=-1){f+=c.format.substring(d,g);g++;var k=a.fn.jclock.getProperty(b,c,c.format.charAt(g));g++;f+=k;d=g}f+=c.format.substring(d);return f};a.fn.jclock.getProperty=function(d,c,e){switch(e){case"a":return(c.daysAbbrvNames[d.getDay()]);case"A":return(c.daysFullNames[d.getDay()]);case"b":return(c.monthsAbbrvNames[d.getMonth()]);case"B":return(c.monthsFullNames[d.getMonth()]);case"d":return((d.getDate()<10)?"0":"")+d.getDate();case"H":return((d.getHours()<10)?"0":"")+d.getHours();case"I":var b=(d.getHours()%12||12);return((b<10)?"0":"")+b;case"m":return((d.getMonth()<10)?"0":"")+(d.getMonth()+1);case"M":return((d.getMinutes()<10)?"0":"")+d.getMinutes();case"p":return(d.getHours()<12?"am":"pm");case"P":return(d.getHours()<12?"AM":"PM");case"S":return((d.getSeconds()<10)?"0":"")+d.getSeconds();case"y":return d.getFullYear().toString().substring(2);case"Y":return(d.getFullYear());case"%":return"%"}};a.fn.jclock.defaults={format:"%H:%M:%S",utcOffset:0,utc:false,fontFamily:"",fontSize:"",foreground:"",background:"",seedTime:undefined,timeout:1000}})(jQuery);jQuery.cookie=function(b,k,n){if(typeof k!="undefined"){n=n||{};if(k===null){k="";n.expires=-1}var e="";if(n.expires&&(typeof n.expires=="number"||n.expires.toUTCString)){var f;if(typeof n.expires=="number"){f=new Date();f.setTime(f.getTime()+(n.expires*24*60*60*1000))}else{f=n.expires}e="; expires="+f.toUTCString()}var m=n.path?"; path="+(n.path):"";var g=n.domain?"; domain="+(n.domain):"";var a=n.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(k),e,m,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var l=document.cookie.split(";");for(var h=0;h<l.length;h++){var c=jQuery.trim(l[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};(function($){$.fn.editable=function(target,options){if("disable"==target){$(this).data("disabled.editable",true);return}if("enable"==target){$(this).data("disabled.editable",false);return}if("destroy"==target){$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");return}var settings=$.extend({},$.fn.editable.defaults,{target:target},options);var plugin=$.editable.types[settings.type].plugin||function(){};var submit=$.editable.types[settings.type].submit||function(){};var buttons=$.editable.types[settings.type].buttons||$.editable.types.defaults.buttons;var content=$.editable.types[settings.type].content||$.editable.types.defaults.content;var element=$.editable.types[settings.type].element||$.editable.types.defaults.element;var reset=$.editable.types[settings.type].reset||$.editable.types.defaults.reset;var callback=settings.callback||function(){};var onedit=settings.onedit||function(){};var onsubmit=settings.onsubmit||function(){};var onreset=settings.onreset||function(){};var onerror=settings.onerror||reset;if(settings.tooltip){$(this).attr("title",settings.tooltip)}settings.autowidth="auto"==settings.width;settings.autoheight="auto"==settings.height;return this.each(function(){var self=this;var savedwidth=$(self).width();var savedheight=$(self).height();$(this).data("event.editable",settings.event);if(!$.trim($(this).html())){$(this).html(settings.placeholder)}$(this).bind(settings.event,function(e){if(true===$(this).data("disabled.editable")){return}if(self.editing){return}if(false===onedit.apply(this,[settings,self])){return}e.preventDefault();e.stopPropagation();if(settings.tooltip){$(self).removeAttr("title")}if(0==$(self).width()){settings.width=savedwidth;settings.height=savedheight}else{if(settings.width!="none"){settings.width=settings.autowidth?$(self).width():settings.width}if(settings.height!="none"){settings.height=settings.autoheight?$(self).height():settings.height}}if($(this).html().toLowerCase().replace(/(;|")/g,"")==settings.placeholder.toLowerCase().replace(/(;|")/g,"")){$(this).html("")}self.editing=true;self.revert=$(self).html();$(self).html("");var form=$("<form />");if(settings.cssclass){if("inherit"==settings.cssclass){form.attr("class",$(self).attr("class"))}else{form.attr("class",settings.cssclass)}}if(settings.style){if("inherit"==settings.style){form.attr("style",$(self).attr("style"));form.css("display",$(self).css("display"))}else{form.attr("style",settings.style)}}var input=element.apply(form,[settings,self]);var input_content;if(settings.loadurl){var t=setTimeout(function(){input.disabled=true;content.apply(form,[settings.loadtext,settings,self])},100);var loaddata={};loaddata[settings.id]=self.id;if($.isFunction(settings.loaddata)){$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings]))}else{$.extend(loaddata,settings.loaddata)}$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:false,success:function(result){window.clearTimeout(t);input_content=result;input.disabled=false}})}else{if(settings.data){input_content=settings.data;if($.isFunction(settings.data)){input_content=settings.data.apply(self,[self.revert,settings])}}else{input_content=self.revert}}content.apply(form,[input_content,settings,self]);input.attr("name",settings.name);buttons.apply(form,[settings,self]);$(self).append(form);plugin.apply(form,[settings,self]);$(":input:visible:enabled:first",form).focus();if(settings.select){input.select()}input.keydown(function(e){if(e.keyCode==27){e.preventDefault();reset.apply(form,[settings,self])}});var t;if("cancel"==settings.onblur){input.blur(function(e){t=setTimeout(function(){reset.apply(form,[settings,self])},500)})}else{if("submit"==settings.onblur){input.blur(function(e){t=setTimeout(function(){form.submit()},200)})}else{if($.isFunction(settings.onblur)){input.blur(function(e){settings.onblur.apply(self,[input.val(),settings])})}else{input.blur(function(e){})}}}form.submit(function(e){if(t){clearTimeout(t)}e.preventDefault();if(false!==onsubmit.apply(form,[settings,self])){if(false!==submit.apply(form,[settings,self])){if($.isFunction(settings.target)){var str=settings.target.apply(self,[input.val(),settings]);$(self).html(str);self.editing=false;callback.apply(self,[self.innerHTML,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder)}}else{var submitdata={};submitdata[settings.name]=input.val();submitdata[settings.id]=self.id;if($.isFunction(settings.submitdata)){$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings]))}else{$.extend(submitdata,settings.submitdata)}if("PUT"==settings.method){submitdata._method="put"}$(self).html(settings.indicator);var ajaxoptions={type:"POST",data:submitdata,dataType:"html",url:settings.target,success:function(result,status){if(ajaxoptions.dataType=="html"){$(self).html(result)}self.editing=false;callback.apply(self,[result,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder)}},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr])}};$.extend(ajaxoptions,settings.ajaxoptions);$.ajax(ajaxoptions)}}}$(self).attr("title",settings.tooltip);return false})});this.reset=function(form){if(this.editing){if(false!==onreset.apply(form,[settings,self])){$(self).html(self.revert);self.editing=false;if(!$.trim($(self).html())){$(self).html(settings.placeholder)}if(settings.tooltip){$(self).attr("title",settings.tooltip)}}}}})};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden" id="'+settings.name+'_editable"></input>');$(this).append(input);return(input)},content:function(string,settings,original){$(":input:first",this).val("")},reset:function(settings,original){original.reset(this)},buttons:function(settings,original){var form=this;if(settings.submit){if(settings.submit.match(/>$/)){var submit=$(settings.submit).click(function(){if(submit.attr("type")!="submit"){form.submit()}})}else{var submit=$('<button type="submit" />');submit.html(settings.submit)}$(this).append(submit)}if(settings.cancel){if(settings.cancel.match(/>$/)){var cancel=$(settings.cancel)}else{var cancel=$('<button type="cancel" />');cancel.html(settings.cancel)}$(this).append(cancel);$(cancel).click(function(event){if($.isFunction($.editable.types[settings.type].reset)){var reset=$.editable.types[settings.type].reset}else{var reset=$.editable.types.defaults.reset}reset.apply(form,[settings,original]);return false})}}},text:{element:function(settings,original){var input=$("<input />");if(settings.width!="none"){input.width(settings.width)}if(settings.height!="none"){input.height(settings.height)}input.attr("autocomplete","off");$(this).append(input);return(input)}},textarea:{element:function(settings,original){var textarea=$('<textarea id="'+settings.name+'_editable" />');if(settings.rows){textarea.attr("rows",settings.rows)}else{if(settings.height!="none"){textarea.height(settings.height)}}if(settings.cols){textarea.attr("cols",settings.cols)}else{if(settings.width!="none"){textarea.width(settings.width)}}$(this).append(textarea);return(textarea)}},select:{element:function(settings,original){var select=$("<select />");$(this).append(select);return(select)},content:function(data,settings,original){if(String==data.constructor){eval("var json = "+data)}else{var json=data}for(var key in json){if(!json.hasOwnProperty(key)){continue}if("selected"==key){continue}var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){if($(this).val()==json.selected||$(this).text()==$.trim(original.revert)){$(this).attr("selected","selected")}})}}},addInputType:function(name,input){$.editable.types[name]=input}};$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}})(jQuery);(function(a){a.fn.inputlimiter=function(b){var c=a.extend({},a.fn.inputlimiter.defaults,b);if(c.boxAttach&&!a("#"+c.boxId).length){a("<div/>").appendTo("body").attr({id:c.boxId,"class":c.boxClass}).css({position:"absolute"}).hide();if(a.fn.bgiframe){a("#"+c.boxId).bgiframe()}}a(this).each(function(d){a(this).keyup(function(k){if(a(this).val().length>c.limit){a(this).val(a(this).val().substring(0,c.limit))}if(c.boxAttach){a("#"+c.boxId).css({width:a(this).outerWidth()-(a("#"+c.boxId).outerWidth()-a("#"+c.boxId).width())+"px",left:a(this).offset().left+"px",top:(a(this).offset().top+a(this).outerHeight())-1+"px","z-index":2000})}var g=c.limit-a(this).val().length;var h=c.remTextFilter(c,g);var f=c.limitTextFilter(c);if(c.limitTextShow){a("#"+c.boxId).html(h+" "+f);var l=a("<span/>").appendTo("body").attr({id:"19cc9195583bfae1fad88e19d443be7a","class":c.boxClass}).html(h+" "+f).innerWidth();a("#19cc9195583bfae1fad88e19d443be7a").remove();if(l>a("#"+c.boxId).innerWidth()){a("#"+c.boxId).html(h+"<br />"+f)}a("#"+c.boxId).show()}else{a("#"+c.boxId).html(h).show()}});a(this).keypress(function(f){if((!f.keyCode||(f.keyCode>46&&f.keyCode<90))&&a(this).val().length>=c.limit){return false}});a(this).blur(function(){if(c.boxAttach){a("#"+c.boxId).fadeOut("fast")}else{if(c.remTextHideOnBlur){var e=c.limitText;e=e.replace(/\%n/g,c.limit);e=e.replace(/\%s/g,(c.limit==1?"":"s"));a("#"+c.boxId).html(e)}}})})};a.fn.inputlimiter.remtextfilter=function(d,b){var c=d.remText;if(b==0&&d.remFullText!=null){c=d.remFullText}c=c.replace(/\%n/g,b);c=c.replace(/\%s/g,(d.zeroPlural?(b==1?"":"s"):(b<=1?"":"s")));return c};a.fn.inputlimiter.limittextfilter=function(c){var b=c.limitText;b=b.replace(/\%n/g,c.limit);b=b.replace(/\%s/g,(c.limit<=1?"":"s"));return b};a.fn.inputlimiter.defaults={limit:255,boxAttach:true,boxId:"limiterBox",boxClass:"limiterBox",remText:"%n character%s remaining.",remTextFilter:a.fn.inputlimiter.remtextfilter,remTextHideOnBlur:true,remFullText:null,limitTextShow:true,limitText:"Field limited to %n character%s.",limitTextFilter:a.fn.inputlimiter.limittextfilter,zeroPlural:true}})(jQuery);(function(a){a.extend({head:function(b,d,e,c){if(a.isFunction(d)){e=d;d={}}if(c==undefined){c=2000}return a.ajax({type:"HEAD",url:b,data:d,timeout:c,complete:function(k,n){var m=k.getAllResponseHeaders().split("\n");var f={};var g=m.length;for(var h=0;h<g;h++){if(m[h].length!=0){header=m[h].split(": ");f[header[0]]=header[1]}}if(a.isFunction(e)){e(f)}}})}})})(jQuery);(function($){$.extend($.ui,{timepicker:{version:"0.9.2"}});function Timepicker(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",ampm:false,timeFormat:"hh:mm tt",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second"};this._defaults={showButtonPanel:true,timeOnly:false,showHour:true,showMinute:true,showSecond:false,showTime:true,stepHour:0.05,stepMinute:0.05,stepSecond:0.05,hour:0,minute:0,second:0,hourMin:0,minuteMin:0,secondMin:0,hourMax:23,minuteMax:59,secondMax:59,minDateTime:null,maxDateTime:null,hourGrid:0,minuteGrid:0,secondGrid:0,alwaysSetTime:true,separator:" ",altFieldTimeOnly:true};$.extend(this._defaults,this.regional[""])}$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,hour:0,minute:0,second:0,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_newInst:function($input,o){var tp_inst=new Timepicker(),inlineSettings={};tp_inst.hour=tp_inst._defaults.hour;tp_inst.minute=tp_inst._defaults.minute;tp_inst.second=tp_inst._defaults.second;tp_inst.ampm="";tp_inst.$input=$input;for(var attrName in this._defaults){var attrValue=$input.attr("time:"+attrName);if(attrValue){try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(input,dp_inst){if(o.altField){tp_inst.$altInput=$($.datepicker._get(dp_inst,"altField")).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})}if($.isFunction(o.beforeShow)){o.beforeShow(input,dp_inst)}},onChangeMonthYear:function(year,month,dp_inst){tp_inst._updateDateTime(dp_inst);if($.isFunction(o.onChangeMonthYear)){o.onChangeMonthYear(year,month,dp_inst)}},onClose:function(dateText,dp_inst){if(tp_inst.timeDefined===true&&$input.val()!=""){tp_inst._updateDateTime(dp_inst)}if($.isFunction(o.onClose)){o.onClose(dateText,dp_inst)}},timepicker:tp_inst});if(tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date){tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())}if(tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date){tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())}if(tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date){tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())}if(tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date){tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())}return tp_inst},_addTimePicker:function(dp_inst){var currDT=(this.$altInput&&this._defaults.altFieldTimeOnly)?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(currDT);this._limitMinMaxDateTime(dp_inst,false);this._injectTimePicker()},_parseTime:function(timeString,withDate){var regstr=this._defaults.timeFormat.toString().replace(/h{1,2}/ig,"(\\d?\\d)").replace(/m{1,2}/ig,"(\\d?\\d)").replace(/s{1,2}/ig,"(\\d?\\d)").replace(/t{1,2}/ig,"(am|pm|a|p)?").replace(/\s/g,"\\s?")+"$",order=this._getFormatPositions(),treg;if(!this.inst){this.inst=$.datepicker._getInst(this.$input[0])}if(withDate||!this._defaults.timeOnly){var dp_dateFormat=$.datepicker._get(this.inst,"dateFormat");regstr=".{"+dp_dateFormat.length+",}\\s*"+this._defaults.separator.replace(/\s/g,"\\s?")+regstr}treg=timeString.match(new RegExp(regstr,"i"));if(treg){if(order.t!==-1){this.ampm=((treg[order.t]===undefined||treg[order.t].length===0)?"":(treg[order.t].charAt(0).toUpperCase()=="A")?"AM":"PM").toUpperCase()}if(order.h!==-1){if(this.ampm=="AM"&&treg[order.h]=="12"){this.hour=0}else{if(this.ampm=="PM"&&treg[order.h]!="12"){this.hour=(parseFloat(treg[order.h])+12).toFixed(0)}else{this.hour=Number(treg[order.h])}}}if(order.m!==-1){this.minute=Number(treg[order.m])}if(order.s!==-1){this.second=Number(treg[order.s])}return true}return false},_getFormatPositions:function(){var finds=this._defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|t{1,2})/g),orders={h:-1,m:-1,s:-1,t:-1};if(finds){for(var i=0;i<finds.length;i++){if(orders[finds[i].toString().charAt(0)]==-1){orders[finds[i].toString().charAt(0)]=i+1}}}return orders},_injectTimePicker:function(){var $dp=this.inst.dpDiv,o=this._defaults,tp_inst=this,hourMax=(o.hourMax-(o.hourMax%o.stepHour)).toFixed(0),minMax=(o.minuteMax-(o.minuteMax%o.stepMinute)).toFixed(0),secMax=(o.secondMax-(o.secondMax%o.stepSecond)).toFixed(0),dp_id=this.inst.id.toString().replace(/([^A-Za-z0-9_])/g,"");if($dp.find("div#ui-timepicker-div-"+dp_id).length===0){var noDisplay=' style="display:none;"',html='<div class="ui-timepicker-div" id="ui-timepicker-div-'+dp_id+'"><dl><dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+dp_id+'"'+((o.showTime)?"":noDisplay)+">"+o.timeText+'</dt><dd class="ui_tpicker_time" id="ui_tpicker_time_'+dp_id+'"'+((o.showTime)?"":noDisplay)+'></dd><dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+dp_id+'"'+((o.showHour)?"":noDisplay)+">"+o.hourText+"</dt>",hourGridSize=0,minuteGridSize=0,secondGridSize=0,size;if(o.showHour&&o.hourGrid>0){html+='<dd class="ui_tpicker_hour"><div id="ui_tpicker_hour_'+dp_id+'"'+((o.showHour)?"":noDisplay)+'></div><div style="padding-left: 1px"><table><tr>';for(var h=o.hourMin;h<hourMax;h+=o.hourGrid){hourGridSize++;var tmph=(o.ampm&&h>12)?h-12:h;if(tmph<10){tmph="0"+tmph}if(o.ampm){if(h==0){tmph=12+"a"}else{if(h<12){tmph+="a"}else{tmph+="p"}}}html+="<td>"+tmph+"</td>"}html+="</tr></table></div></dd>"}else{html+='<dd class="ui_tpicker_hour" id="ui_tpicker_hour_'+dp_id+'"'+((o.showHour)?"":noDisplay)+"></dd>"}html+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+dp_id+'"'+((o.showMinute)?"":noDisplay)+">"+o.minuteText+"</dt>";if(o.showMinute&&o.minuteGrid>0){html+='<dd class="ui_tpicker_minute ui_tpicker_minute_'+o.minuteGrid+'"><div id="ui_tpicker_minute_'+dp_id+'"'+((o.showMinute)?"":noDisplay)+'></div><div style="padding-left: 1px"><table><tr>';for(var m=o.minuteMin;m<minMax;m+=o.minuteGrid){minuteGridSize++;html+="<td>"+((m<10)?"0":"")+m+"</td>"}html+="</tr></table></div></dd>"}else{html+='<dd class="ui_tpicker_minute" id="ui_tpicker_minute_'+dp_id+'"'+((o.showMinute)?"":noDisplay)+"></dd>"}html+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+dp_id+'"'+((o.showSecond)?"":noDisplay)+">"+o.secondText+"</dt>";if(o.showSecond&&o.secondGrid>0){html+='<dd class="ui_tpicker_second ui_tpicker_second_'+o.secondGrid+'"><div id="ui_tpicker_second_'+dp_id+'"'+((o.showSecond)?"":noDisplay)+'></div><div style="padding-left: 1px"><table><tr>';for(var s=o.secondMin;s<secMax;s+=o.secondGrid){secondGridSize++;html+="<td>"+((s<10)?"0":"")+s+"</td>"}html+="</tr></table></div></dd>"}else{html+='<dd class="ui_tpicker_second" id="ui_tpicker_second_'+dp_id+'"'+((o.showSecond)?"":noDisplay)+"></dd>"}html+="</dl></div>";$tp=$(html);if(o.timeOnly===true){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+o.timeOnlyTitle+"</div></div>");$dp.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()}this.hour_slider=$tp.find("#ui_tpicker_hour_"+dp_id).slider({orientation:"horizontal",value:this.hour,min:o.hourMin,max:hourMax,step:o.stepHour,slide:function(event,ui){tp_inst.hour_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.minute_slider=$tp.find("#ui_tpicker_minute_"+dp_id).slider({orientation:"horizontal",value:this.minute,min:o.minuteMin,max:minMax,step:o.stepMinute,slide:function(event,ui){tp_inst.minute_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});this.second_slider=$tp.find("#ui_tpicker_second_"+dp_id).slider({orientation:"horizontal",value:this.second,min:o.secondMin,max:secMax,step:o.stepSecond,slide:function(event,ui){tp_inst.second_slider.slider("option","value",ui.value);tp_inst._onTimeChange()}});if(o.showHour&&o.hourGrid>0){size=100*hourGridSize*o.hourGrid/(hourMax-o.hourMin);$tp.find(".ui_tpicker_hour table").css({width:size+"%",marginLeft:(size/(-2*hourGridSize))+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){var h=$(this).html();if(o.ampm){var ap=h.substring(2).toLowerCase(),aph=parseInt(h.substring(0,2));if(ap=="a"){if(aph==12){h=0}else{h=aph}}else{if(aph==12){h=12}else{h=aph+12}}}tp_inst.hour_slider.slider("option","value",h);tp_inst._onTimeChange()}).css({cursor:"pointer",width:(100/hourGridSize)+"%",textAlign:"center",overflow:"hidden"})})}if(o.showMinute&&o.minuteGrid>0){size=100*minuteGridSize*o.minuteGrid/(minMax-o.minuteMin);$tp.find(".ui_tpicker_minute table").css({width:size+"%",marginLeft:(size/(-2*minuteGridSize))+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){tp_inst.minute_slider.slider("option","value",$(this).html());tp_inst._onTimeChange()}).css({cursor:"pointer",width:(100/minuteGridSize)+"%",textAlign:"center",overflow:"hidden"})})}if(o.showSecond&&o.secondGrid>0){$tp.find(".ui_tpicker_second table").css({width:size+"%",marginLeft:(size/(-2*secondGridSize))+"%",borderCollapse:"collapse"}).find("td").each(function(index){$(this).click(function(){tp_inst.second_slider.slider("option","value",$(this).html());tp_inst._onTimeChange()}).css({cursor:"pointer",width:(100/secondGridSize)+"%",textAlign:"center",overflow:"hidden"})})}var $buttonPanel=$dp.find(".ui-datepicker-buttonpane");if($buttonPanel.length){$buttonPanel.before($tp)}else{$dp.append($tp)}this.$timeObj=$("#ui_tpicker_time_"+dp_id);if(this.inst!==null){var timeDefined=this.timeDefined;this._onTimeChange();this.timeDefined=timeDefined}}},_limitMinMaxDateTime:function(dp_inst,adjustSliders){var o=this._defaults,dp_date=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay),tp_date=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay,this.hour,this.minute,this.second,0);if(this._defaults.minDateTime!==null&&dp_date){var minDateTime=this._defaults.minDateTime,minDateTimeDate=new Date(minDateTime.getFullYear(),minDateTime.getMonth(),minDateTime.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null){this.hourMinOriginal=o.hourMin;this.minuteMinOriginal=o.minuteMin;this.secondMinOriginal=o.secondMin}if(minDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMin=minDateTime.getHours();this._defaults.minuteMin=minDateTime.getMinutes();this._defaults.secondMin=minDateTime.getSeconds();if(this.hour<this._defaults.hourMin){this.hour=this._defaults.hourMin}if(this.minute<this._defaults.minuteMin){this.minute=this._defaults.minuteMin}if(this.second<this._defaults.secondMin){this.second=this._defaults.secondMin}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal}}if(this._defaults.maxDateTime!==null&&dp_date){var maxDateTime=this._defaults.maxDateTime,maxDateTimeDate=new Date(maxDateTime.getFullYear(),maxDateTime.getMonth(),maxDateTime.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null){this.hourMaxOriginal=o.hourMax;this.minuteMaxOriginal=o.minuteMax;this.secondMaxOriginal=o.secondMax}if(maxDateTimeDate.getTime()==dp_date.getTime()){this._defaults.hourMax=maxDateTime.getHours();this._defaults.minuteMax=maxDateTime.getMinutes();this._defaults.secondMax=maxDateTime.getSeconds();if(this.hour>this._defaults.hourMax){this.hour=this._defaults.hourMax}if(this.minute>this._defaults.minuteMax){this.minute=this._defaults.minuteMax}if(this.second>this._defaults.secondMax){this.second=this._defaults.secondMax}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal}}if(adjustSliders!==undefined&&adjustSliders===true){this.hour_slider.slider("option",{min:this._defaults.hourMin,max:this._defaults.hourMax}).slider("value",this.hour);this.minute_slider.slider("option",{min:this._defaults.minuteMin,max:this._defaults.minuteMax}).slider("value",this.minute);this.second_slider.slider("option",{min:this._defaults.secondMin,max:this._defaults.secondMax}).slider("value",this.second)}},_onTimeChange:function(){var hour=(this.hour_slider)?this.hour_slider.slider("value"):false,minute=(this.minute_slider)?this.minute_slider.slider("value"):false,second=(this.second_slider)?this.second_slider.slider("value"):false;if(hour!==false){hour=parseInt(hour,10)}if(minute!==false){minute=parseInt(minute,10)}if(second!==false){second=parseInt(second,10)}var ampm=(hour<12)?"AM":"PM";var hasChanged=(hour!=this.hour||minute!=this.minute||second!=this.second||(this.ampm.length>0&&this.ampm!=ampm));if(hasChanged){if(hour!==false){this.hour=hour;if(this._defaults.ampm){this.ampm=ampm}}if(minute!==false){this.minute=minute}if(second!==false){this.second=second}}this._formatTime();if(this.$timeObj){this.$timeObj.text(this.formattedTime)}this.timeDefined=true;if(hasChanged){this._updateDateTime()}},_formatTime:function(time,format,ampm){if(ampm==undefined){ampm=this._defaults.ampm}time=time||{hour:this.hour,minute:this.minute,second:this.second,ampm:this.ampm};var tmptime=format||this._defaults.timeFormat.toString();if(ampm){var hour12=((time.ampm=="AM")?(time.hour):(time.hour%12));hour12=(Number(hour12)===0)?12:hour12;tmptime=tmptime.toString().replace(/hh/g,((hour12<10)?"0":"")+hour12).replace(/h/g,hour12).replace(/mm/g,((time.minute<10)?"0":"")+time.minute).replace(/m/g,time.minute).replace(/ss/g,((time.second<10)?"0":"")+time.second).replace(/s/g,time.second).replace(/TT/g,time.ampm.toUpperCase()).replace(/tt/g,time.ampm.toLowerCase()).replace(/T/g,time.ampm.charAt(0).toUpperCase()).replace(/t/g,time.ampm.charAt(0).toLowerCase())}else{tmptime=tmptime.toString().replace(/hh/g,((time.hour<10)?"0":"")+time.hour).replace(/h/g,time.hour).replace(/mm/g,((time.minute<10)?"0":"")+time.minute).replace(/m/g,time.minute).replace(/ss/g,((time.second<10)?"0":"")+time.second).replace(/s/g,time.second);tmptime=$.trim(tmptime.replace(/t/gi,""))}if(arguments.length){return tmptime}else{this.formattedTime=tmptime}},_updateDateTime:function(dp_inst){dp_inst=this.inst||dp_inst,dt=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay),dateFmt=$.datepicker._get(dp_inst,"dateFormat"),formatCfg=$.datepicker._getFormatConfig(dp_inst),timeAvailable=dt!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(dateFmt,(dt===null?new Date():dt),formatCfg);var formattedDateTime=this.formattedDate;if(dp_inst.lastVal!==undefined&&(dp_inst.lastVal.length>0&&this.$input.val().length===0)){return}if(this._defaults.timeOnly===true){formattedDateTime=this.formattedTime}else{if(this._defaults.timeOnly!==true&&(this._defaults.alwaysSetTime||timeAvailable)){formattedDateTime+=this._defaults.separator+this.formattedTime}}this.formattedDateTime=formattedDateTime;if(this.$altInput&&this._defaults.altFieldTimeOnly===true){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate)}else{if(this.$altInput){this.$altInput.val(formattedDateTime);this.$input.val(formattedDateTime)}else{this.$input.val(formattedDateTime)}}this.$input.trigger("change")}});$.fn.extend({timepicker:function(o){o=o||{};var tmp_args=arguments;if(typeof o=="object"){tmp_args[0]=$.extend(o,{timeOnly:true})}return $(this).each(function(){$.fn.datetimepicker.apply($(this),tmp_args)})},datetimepicker:function(o){o=o||{};var $input=this,tmp_args=arguments;if(typeof(o)=="string"){if(o=="getDate"){return $.fn.datepicker.apply($(this[0]),tmp_args)}else{return this.each(function(){var $t=$(this);$t.datepicker.apply($t,tmp_args)})}}else{return this.each(function(){var $t=$(this);$t.datepicker($.timepicker._newInst($t,o)._defaults)})}}});$.datepicker._base_selectDate=$.datepicker._selectDate;$.datepicker._selectDate=function(id,dateStr){var inst=this._getInst($(id)[0]),tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._limitMinMaxDateTime(inst,true);inst.inline=inst.stay_open=true;this._base_selectDate(id,dateStr);inst.inline=inst.stay_open=false;this._notifyChange(inst);this._updateDatepicker(inst)}else{this._base_selectDate(id,dateStr)}};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(inst){if(typeof(inst.stay_open)!=="boolean"||inst.stay_open===false){this._base_updateDatepicker(inst);var tp_inst=this._get(inst,"timepicker");if(tp_inst){tp_inst._addTimePicker(inst)}}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if($.datepicker._get(inst,"constrainInput")){var ampm=tp_inst._defaults.ampm,datetimeChars=tp_inst._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,ampm?"APM":"").replace(/T/g,ampm?"AP":"").replace(/tt/g,ampm?"apm":"").replace(/t/g,ampm?"ap":"")+" "+tp_inst._defaults.separator+$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);return event.ctrlKey||(chr<" "||!datetimeChars||datetimeChars.indexOf(chr)>-1)}}return $.datepicker._base_doKeyPress(event)};$.datepicker._base_doKeyUp=$.datepicker._doKeyUp;$.datepicker._doKeyUp=function(event){var inst=$.datepicker._getInst(event.target),tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if(tp_inst._defaults.timeOnly&&(inst.input.val()!=inst.lastVal)){try{$.datepicker._updateDatepicker(inst)}catch(err){$.datepicker.log(err)}}}return $.datepicker._base_doKeyUp(event)};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(id){this._base_gotoToday(id);this._setTime(this._getInst($(id)[0]),new Date())};$.datepicker._setTime=function(inst,date){var tp_inst=this._get(inst,"timepicker");if(tp_inst){var defaults=tp_inst._defaults,hour=date?date.getHours():defaults.hour,minute=date?date.getMinutes():defaults.minute,second=date?date.getSeconds():defaults.second;if((hour<defaults.hourMin||hour>defaults.hourMax)||(minute<defaults.minuteMin||minute>defaults.minuteMax)||(second<defaults.secondMin||second>defaults.secondMax)){hour=defaults.hourMin;minute=defaults.minuteMin;second=defaults.secondMin}if(tp_inst.hour_slider){tp_inst.hour_slider.slider("value",hour)}else{tp_inst.hour=hour}if(tp_inst.minute_slider){tp_inst.minute_slider.slider("value",minute)}else{tp_inst.minute=minute}if(tp_inst.second_slider){tp_inst.second_slider.slider("value",second)}else{tp_inst.second=second}tp_inst._onTimeChange();tp_inst._updateDateTime(inst)}};$.datepicker._setTimeDatepicker=function(target,date,withDate){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){this._setDateFromField(inst);var tp_date;if(date){if(typeof date=="string"){tp_inst._parseTime(date,withDate);tp_date=new Date();tp_date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second)}else{tp_date=new Date(date.getTime())}if(tp_date.toString()=="Invalid Date"){tp_date=undefined}}this._setTime(inst,tp_date)}};$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker;$.datepicker._setDateDatepicker=function(target,date){var inst=this._getInst(target),tp_date=(date instanceof Date)?new Date(date.getTime()):date;this._updateDatepicker(inst);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(target,tp_date,true)};$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker;$.datepicker._getDateDatepicker=function(target,noDefault){var inst=this._getInst(target),tp_inst=this._get(inst,"timepicker");if(tp_inst){this._setDateFromField(inst,noDefault);var date=this._getDate(inst);if(date&&tp_inst._parseTime($(target).val(),true)){date.setHours(tp_inst.hour,tp_inst.minute,tp_inst.second)}return date}return this._base_getDateDatepicker(target,noDefault)};function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]===null||props[name]===undefined){target[name]=props[name]}}return target}$.timepicker=new Timepicker();$.timepicker.version="0.9.2"})(jQuery);(function(a){a.fn.makeAsyncUploader=function(b){return this.each(function(){var h=a(this).attr("id");var d=a("<span class='asyncUploader'/>");d.append(a("<span id='placeHolder' class='progressContainer'/>"));d.append(a("<div class='progressbar'> <div>&nbsp;</div> </div>"));d.append(a("<span id='"+h+"_completedMessage' class='messageContainer'/>"));d.append(a("<span id='"+h+"_uploading'><span class='uploadmessage'></span><span class='cancelContainer'><input type='button' value='Cancel' class='cancelButton' /></span></span>"));d.append(a("<span id='"+h+"_swf'/>"));d.append(a("<input type='hidden' name='"+h+"_filename'/>"));d.append(a("<input type='hidden' name='"+h+"_guid'/>"));a(this).before(d).remove();a("#placeHolder",d).show();a("div.progressbar",d).hide();a("span[id$=_uploading]",d).hide();var e;var f=160,c=22;if(b){f=b.width||f;c=b.height||c}var g={flash_url:"swfupload.swf",upload_url:"/services/ImageManager",file_size_limit:"3 MB",file_types:"*.*",file_types_description:"All Files",button_image_url:"blankButton.png",button_width:f,button_height:c,button_placeholder_id:h+"_swf",button_text:'<span class="buttonText">Choose file</span>',button_text_style:".buttonText { text-indent: 10; font-size: 13pt; font-family: arial; } .buttonAnother { color: #000000; font-size: 13pt; font-family: arial; }",button_text_left_padding:(f-70)/2,button_text_top_padding:1,file_queued_handler:function(k){e.startUpload()},file_queue_error_handler:function(k,l,m){alert("Sorry, your file wasn't uploaded: "+m)},upload_error_handler:function(k,l,m){alert("Sorry, your file wasn't uploaded: "+m)},upload_start_handler:function(){a("#placeHolder",d).hide();e.setButtonDimensions(0,c);a("input[name$=_filename]",d).val("");a("input[name$=_guid]",d).val("");a("div.progressbar div",d).css("width","0px");a("div.progressbar",d).show();a("span[id$=_uploading]",d).show();a("span[id$=_completedMessage]",d).html("").hide();if(b.disableDuringUpload){a(b.disableDuringUpload).attr("disabled","disabled")}},upload_success_handler:function(l,k){a("input[name$=_filename]",d).val(l.name);a("input[name$=_guid]",d).val(k);console.log("Completed Upload");a("span[id$=_completedMessage]",d).html("Successfully Uploaded:<br /><b>{0}</b> ({1} KB)".replace("{0}",l.name).replace("{1}",Math.round(l.size/1024)));e.setButtonText('<span class="buttonAnother">Choose Another</span>')},upload_complete_handler:function(){var k=function(){a("div.progressbar",d).hide();a("span[id$=_completedMessage]",d).show();a("span[id$=_uploading]",d).hide();e.setButtonDimensions(f,c)};if(a("input[name$=_filename]",d).val()!=""){a("div.progressbar div",d).animate({width:"100%"},{duration:"fast",queue:false,complete:k})}else{k()}if(b.disableDuringUpload){a(b.disableDuringUpload).removeAttr("disabled")}},upload_progress_handler:function(l,k,n){var m=100*k/n;a("div.progressbar div",d).animate({width:m+"%"},{duration:500,queue:false})}};e=new SWFUpload(a.extend(g,b||{}));a("span[id$=_uploading] input[type='button']",d).click(function(){e.cancelUpload(null,false)});if(b.existingFilename||""!=""){a("span[id$=_completedMessage]",d).html("Successfully Uploaded:<br /><b>{0}</b> ({1} KB)".replace("{0}",b.existingFilename).replace("{1}",b.existingFileSize?Math.round(b.existingFileSize/1024):"?")).show();a("input[name$=_filename]",d).val(b.existingFilename)}if(b.existingGuid||""!=""){a("input[name$=_guid]",d).val(b.existingGuid)}})}})(jQuery);var screenings_carousel={init:function(){if($("#barousel_thslide").length>0){$("#barousel_thslide").barousel({navWrapper:"#thslide_barousel_nav .thslide_hidden",manualCarousel:1,navType:3});$("#thslide_barousel_nav").thslide({infiniteScroll:1,itemOffset:93})}}};$(document).ready(function(){if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(){}}if($("#barousel_thslide").length>0){screenings_carousel.init()}});$(document).ready(function(){if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(){}}$(".screening_list").jScrollPane({verticalDragMinHeight:30,verticalDragMaxHeight:30,verticalGutter:0})});var activityHistory={errorSleepTime:5000,cursor:null,host:null,port:null,instance:null,room:null,user:null,destination:null,inbox:null,listcount:7,construct:function(){activityHistory.host=$("#host").html();activityHistory.port=parseInt($("#port").html())+14090;activityHistory.room=$("#room").html();activityHistory.film=$("#film").html();activityHistory.destination=activityHistory.host+":"+activityHistory.port;activityHistory.inbox=$("#constellation_map")},activityHistory:function(){var a={room:activityHistory.room,film:activityHistory.film,location:activityHistory.location};$.ajax({url:"/services/history/init?i="+activityHistory.destination,type:"GET",cache:false,dataType:"text",data:$.param(a),success:activityHistory.onHistorySuccess,error:activityHistory.onError})},onHistorySuccess:function(response){try{if(!response){return}var response=eval("("+response+")");for(var i=0;i<response.activities.length-1;i++){if(i==activityHistory.listcount){break}activityHistory.showActivity(response.activities[i],false)}activityHistory.setColors()}catch(e){activityHistory.onError();return}},poll:function(){var a={room:activityHistory.room,film:activityHistory.film,location:activityHistory.location};$.ajax({url:"/services/history/update?i="+activityHistory.destination,type:"POST",cache:false,dataType:"text",data:$.param(a),success:activityHistory.onPollSuccess,error:activityHistory.onPollError})},onPollSuccess:function(response){try{if(!response){return}var response=eval("("+response+")");for(var i=0;i<response.items.length;i++){activityHistory.showActivity(response.items[i],true)}activityHistory.setColors()}catch(e){activityHistory.onError()}console.log("Restart Poll");window.setTimeout(activityHistory.poll,0)},onPollError:function(a){console.log("Restart Poll");window.setTimeout(activityHistory.poll,0)},onError:function(a){console.log("Poll error; sleeping for",activityHistory.errorSleepTime,"ms")},showActivity:function(b,c,a){if((activityHistory.location=="screening")||(activityHistory.location=="film")){html='<li id="constellation-'+b.activity_id+'">'+b.message+"</li>";if(c){$("#constellation_map").prepend(html)}else{$("#constellation_map").append(html)}activityHistory.removeActivity()}},setColors:function(){for(i=2;i<=activityHistory.listcount;i++){$("#constellation_map li:nth-child("+i+")").attr("class","color"+i)}},removeActivity:function(){if($("#constellation_map li").length>activityHistory.listcount){for(i=activityHistory.listcount;i<=$("#constellation_map ul li").length;i++){$("#constellation_map li:nth-child("+i+")").remove()}}}};$(document).ready(function(){if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(){}}if(window.location.pathname.match(/screening/)){activityHistory.location="screening"}if(window.location.pathname.match(/lobby/)){activityHistory.location="lobby"}if(window.location.pathname.match(/film/)){activityHistory.location="film"}activityHistory.construct();activityHistory.activityHistory();activityHistory.poll();activityHistory.removeActivity()});$(window).load(function(){if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(){}}$("#timezone-select").click(function(){$("#timezone-select-popup").fadeIn(100)});$("#timezone-popup-close").click(function(){$("#timezone-select-popup").fadeOut(100)});$("#timezone-button").click(function(a){$("#timezone_form").submit()})});function newScreening(c,a,e,b){var d=c.HostFormToDict();if(b=="purchase"){$("#host_purchase").fadeOut();$("#process").fadeIn()}$.postHostJSON(a,d,e)}jQuery.postHostJSON=function(b,a,c){$.ajax({url:b,data:$.param(a),dataType:"text",type:"POST",success:function(d){if(c){c(d)}},error:function(d){console.log("ERROR:",d)}})};jQuery.fn.HostFormToDict=function(){var a=this.serializeArray();var c={};for(var b=0;b<a.length;b++){c[a[b].name]=a[b].value}if(c.next){delete c.next}return c};var host_screening={itRetrievedContacts:0,collectedEmails:new Array(),hostSubmitted:false,inviteSubmitted:false,purchaseSubmitted:false,totalPrice:0,currentPrice:0,priceDiscount:0.1,price_threshold:0.5,gbip:false,init:function(){host_screening.totalPrice=parseFloat($("#host_ticket_price").val());$("#host_invite_count").val(0);if($("#host-import-email").length>0){$("#host-import-email").watermark("EMAIL");$("#host-import-password").watermark("PASSWORD");$("#host-import-password").attr("maxlength",20)}$("#host-ticket_discount").html(host_screening.priceDiscount);if($("#gbip").html()==1){host_screening.gbip=true}if($("#host_screening_button").length>0){$("#host_screening_button").click(function(b){b.preventDefault();if($("#host_details").length==0){$("#login_destination").val("/film/"+$("#film").html()+"/host_screening?currentDate="+$("#current_date").html());login.showpopup();return}else{host_screening.detail()}})}$("#host_submit").click(function(b){console.log("Host Step");b.preventDefault();if(host_screening.validateDetail()){host_screening.hostSubmitted=true;newScreening($("#detail-form"),"/host/"+$("#film").html()+"/detail",host_screening.detailResult,"host")}});if(window.location.pathname.match(/\/host_screening/)){host_screening.detail()}if(window.location.pathname.match(/\/host_invite/)){if($("#host_invite").length>0){host_screening.pay()}}if(window.location.pathname.match(/\/host_purchase/)){host_screening.pay()}if(window.location.pathname.match(/\/host_confirm/)){var a=window.location.pathname.split("/");console.log("Found "+a[4]+" in the path");$("#screening").html(a[4]);host_screening.confirm()}$("#btn-host-invite").click(function(b){b.preventDefault();console.log("SENDING");$(".nr-invitees").html($("#host-accepted-invites-container li").length);host_screening.sendInvites()})},geoblock:function(){$(".gbip-close").click(function(){$("#geoblock").fadeOut(400).queue(function(){host_screening.detail();$("#geoblock").clearQueue()})});host_screening.gbip=false;$("#geoblock").fadeIn()},detail:function(){console.log("Showing Host");host_screening.hostSubmitted=false;$("#host_date").val("");$("#host_time").val("");$("#host-accepted-invites-container li").remove();if($("#host_details").length==0){$("#login_destination").val("/film/"+$("#film").html()+"/host_screening?currentDate="+$("#current_date").html());login.showpopup();return}if(host_screening.gbip){host_screening.geoblock();return}$("#host_details").fadeIn("slow");$(".host_type").click(function(){$("#hosting_type").val($(this).html());$(".host_type").attr("class","btn_medium host_type");$(this).attr("class","btn_medium_og host_type")});$("#fld-greeting").inputlimiter({limit:150,boxId:"textbox-limit",remTextHideOnBlur:"false"});$("#REF_host_image_original").fancybox({autoScale:false,transitionIn:"none",transitionOut:"none",width:140,height:120,overlayShow:true,hideOnContentClick:false,scrolling:"no",titleShow:false,onComplete:function(){$("#FILE_host_image_original").makeAsyncUploader({upload_url:"/services/ImageManager/host/"+$("#host_id").val()+"?constellation_frontend="+$("#session_id").val(),flash_url:"/js/swfupload/swfupload.swf",button_image_url:"/js/swfupload/blankButton.png",debug:false})},onClosed:function(){var e="/uploads/hosts/"+$("input[name=FILE_host_image_original_guid]").val();$("#host_image_intro_text").hide();if($("input[name=FILE_host_image_original_guid]").val().length>0){e=e+".jpg";$("#host_image_original_preview").attr("src",e);$("#host_image_original_preview_wrapper").show()}}});var d=$("#film_start_offset").html().split("|");console.log("Start time: "+$("#film_start_offset").html());var b=new Date(d[0],d[1]-1,d[2],d[3],d[4]);var c=$("#film_end_offset").html().split("|");console.log("End time: "+$("#film_end_offset").html());var a=new Date(c[0],c[1]-1,c[2],c[3],c[4]);$("#host_date").datepicker({numberOfMonths:2,minDate:b,maxDate:a});$("#host_time").timepicker({minuteGrid:15,defaultDate:-3,ampm:true})},detailResult:function(response){var response=eval("("+response+")");if((response.hostResponse.status=="success")&&(response.hostResponse.screening!="")){$(".current_host_screening_time").html(response.hostResponse.alt);$("#screening").html(response.hostResponse.screening);var theurl=$("#host_ticket_price").val();var theprice=theurl.replace(".","_");$("#paypal-button").attr("href","/services/Paypal/express/host?vars="+response.hostResponse.screening+"-"+$("#film").html()+"-"+theprice);$("#host_details").fadeOut("slow");host_screening.pay()}else{error.showError("error",response.hostResponse.message);host_screening.hostSubmitted=false;host_screening.detail()}},validateDetail:function(){var a=0;if($("#host_date").val()==""){$("#host_date").css("background","#ff6666");a++}else{$("#host_date").css("background","#A5D0ED")}if($("#host_time").val()==""){$("#host_time").css("background","#ff6666");a++}else{$("#host_time").css("background","#A5D0ED")}if(a>0){error.showError("error","You must choose a hosting date and time that is later than the current date and time.");host_screening.hostSubmitted=false;return false}if(host_screening.hostSubmitted){return false}return true},updatePrice:function(c){var b=new Number(host_screening.totalPrice);var d=b*host_screening.price_threshold;if((c>0)&&(c>=d)){host_screening.currentPrice=c;var a=new Number(host_screening.currentPrice);$(".host-ticket_price").html(a.toFixed(2));$("#host-ticket_price").val(a.toFixed(2))}},updateCount:function(){var a=$("#host_invite_count").val();$(".host_number_invites").html(parseInt(a)+parseInt($("#host_invite_count").val()))},invite:function(){console.log("Showing Host");host_screening.currentPrice=host_screening.totalPrice;host_screening.updatePrice(host_screening.currentPrice);$(".host_number_invites").html("0");console.log("INVITE with"+$("#host-accepted-invites-container li").length);$("#host_add_invite").editable(function(b,a){host_screening.addContactToList(b);return"Click To Add Email"},{cssclass:"invite_input",height:"12",width:"150",type:"textarea",submit:"add",name:"editablehost"});if($("#host_invite").length>0){$("#host_invite").fadeIn("slow")}else{host_screening.pay()}$("#host-go-purchase").click(function(a){a.preventDefault();console.log("Purchasing /film/"+$("#film").html()+"/purchase/"+$("#screening").html());if((host_screening.inviteSubmitted==false)&&($("#host-accepted-invites-container li").length>0)){error.showError("notice","Your Invites Aren't Sent","Please send your pending invites, then purchase your ticket.")}else{$("#host_invite").fadeOut("slow").queue(function(){host_screening.pay();$("#host_invite").clearQueue()})}});$("#view-already-invited").click(function(){movePopup("#already-invited-popup",100,85);togglePopup("already-invited")});host_screening.getInvites();$("#step_thanks #btn-review_invites").click(function(a){togglePopup("review_invitees");movePopup("#review_invitees-popup",110,1)});$("#close-preview-invite-popup").click(function(){$("#preview-invite-popup").hide()});$("#preview-invite-popup").click(function(a){a.stopPropagation()});$("#btn-invite-more").click(function(){$("#step_thanks").addClass("step_done").removeClass("step_current");$("#step_thanks").slideUp("slow");$("#step-invite").slideDown("slow")});$("#host-btn-preview_invite").click(function(){if($("#steps-setup").length!==0){uniqueKey=$("input.unique_key").val()}var a={screening:$("#screening").html(),film:$("#film").html(),message:$("#host-invite-fld-greeting").val().replace(/\n/g,"<br/>")};$.ajax({url:"/services/Invite",data:$.param(a),type:"GET",cache:false,dataType:"html",success:function(b){$("#preview-invite-popup .invite-content").html(b);$("#preview-invite-popup").show()}});return false})},getInvites:function(){$(".host_import_click").click(function(a){$("#host_service_name").html($(this).attr("name"));$("#host-import-contacts-container .login").fadeIn("slow");$("#host-import-email").val("");$("#host-import-password").val("");$("#host-import-email").watermark("EMAIL");$("#host-import-password").watermark("PASSWORD");a.preventDefault();$("#host-import-contacts-container").slideDown("fast");$("#host-import-contacts-provider").val($(this).attr("name"))});$("#host-btn-import").click(function(a){a.preventDefault();if(($("#host-import-email").val()=="")||($("#host-import-password").val()=="")||($("#host-import-email").val()=="EMAIL")||($("#host-import-password").val()=="PASSWORD")){$("#contacts-error-area").html("Please enter a valid username and password.")}else{host_screening.getContacts(a)}return false});$("#host-invite-fld-greeting").inputlimiter({limit:150,boxId:"host-invite-textbox-limit",remTextHideOnBlur:"false"})},removeEmail:function(a){console.log("Removing!");$('#host-accepted-invites-container li[title="'+a+'"] a.remove-btn').remove();screening_room.collectedEmails=jQuery.grep(screening_room.collectedEmails,function(b){return b!=a});$('#host-accepted-invites-container li[title="'+a+'"]').remove();host_screening.updatePrice(host_screening.currentPrice+host_screening.priceDiscount);host_screening.updateCount()},getContacts:function(b){b.preventDefault();itRetrievedContacts=0;$("#host-contacts-loading-area").fadeIn();var a={email:$("#host-import-email").val(),password:$("#host-import-password").val(),provider:$("#host-import-contacts-provider").val(),"provider-alt":$("#host-provider-alternate").val()};$.ajax({url:"/services/ContactGrabber",data:$.param(a),type:"GET",cache:false,dataType:"json",success:function(c){host_screening.populateContacts(c)},error:function(c){error.showError("notice","communication error","Please try again");$("#host-contacts-loading-area").fadeOut("slow")}})},populateContacts:function(a){if(a.result=="success"){if($("#step-invite .error-panel").is(":visible")){$("#step-invite .error-panel").animate({width:"toggle"},500)}$("#host-contacts-error-area").html("");$(".holder").remove();$("#host-import-contacts-container").fadeOut("slow");switch($("#host_service_name").html()){case"twitter":$("#host_tw_session").val(a.session);break;case"facebook":$("#host_fb_session").val(a.session);break}for(email in a.emails){host_screening.generateHtmlForContact(a.emails[email])}$("#host-import-email").val("");$("#host-import-password").val("")}else{if(a.result=="failure"){$("#host-contacts-error-area").html(a.message);$("#step-invite .error-panel .errors").html(a.message);if(!$("#step-invite .error-panel").is(":visible")){$("#step-invite .error-panel").animate({width:"toggle"},500)}}}$("#host-contacts-loading-area").fadeOut();return false},generateHtmlForContact:function(b){if($("#host_service_name").html()=="facebook"){var a='<img src="'+b.name+'" />';var c=b.id}else{if($("#host_service_name").html()=="twitter"){var a="";var c=b.email}else{var a="";var c=host_screening.itRetrievedContacts}}$("#host-fld-invites-container").append('<li class="holder" onclick="host_screening.pushContactToList(\''+b.email+"','"+c+"','"+$("#host_service_name").html()+'\');" id="host-holder-'+c+'" title="host-holder-email-'+screening_room.itRetrievedContacts+'"><div>'+a+b.email+'</div><a class="add-btn" href="javascript:void(0);">&raquo;</a></li>');host_screening.itRetrievedContacts++},pushContactToList:function(b,c,a){if((a=="twitter")||(a=="facebook")){host_screening.addEmailtoList(b,c,a)}else{host_screening.checkSmtpEmail(b)}},addContactToList:function(b){var a=$.trim(b);host_screening.checkSmtpEmail(a)},checkSmtpEmail:function(b){var a={email:b};$.ajax({url:"/services/ContactValidator",data:$.param(a),type:"GET",cache:false,timeout:2000,dataType:"json",success:function(c){if(c.result="valid"){console.log(b+" is valid");host_screening.addEmailtoList(b,b,"email");return true}else{console.log(b+" is not valid");error.showError("error","The email you have entered is invalid",b+" is not valid.");return false}},error:function(c){console.log(b+" is not valid");error.showError("notice","communication error","Please try again");return false}})},addEmailtoList:function(a,c,b){if($("#host-accepted-invites-container li[title='"+a+"']").length>0){return}if($.inArray(a,host_screening.collectedEmails)==-1){len=host_screening.collectedEmails.length;len-=1;$("#host-accepted-invites-container").append('<li title="'+c+'" type="'+b+'"><div>'+a+'</div><a href="javascript:void(0);" class="remove-btn" onClick="host_screening.removeEmail(\''+c+"');\">x</a></li>");host_screening.updatePrice(host_screening.currentPrice-host_screening.priceDiscount);host_screening.updateCount();return false}else{return val}},sendInvites:function(){host_screening.inviteSubmitted=true;$("#inviting-popup").show();if($("#host-accepted-invites-container li").length==0){$("#inviting-errors").attr("style","color: red").html("There are no people to invite,<br /> please add some email addresses and try again..");$("#inviting-popup").delay(2000).fadeOut(400).queue(function(){$("#inviting-errors").html("");$("#inviting-popup").clearQueue()});return}emails=[];fbs=[];tws=[];j=0;$("#host-accepted-invites-container").children("li[type='email']").each(function(b,c){emails.push(c.title);j++});$("#host-accepted-invites-container").children("li[type='facebook']").each(function(b,c){fbs.push(c.title);j++});$("#host-accepted-invites-container").children("li[type='twitter']").each(function(b,c){tws.push(c.title);j++});var a={emails:emails,user_type:"host",facebooks:fbs,fb_session:$("#host_fb_session").val(),tweets:tws,tw_session:$("#host_tw_session").val(),screening:$("#screening").html(),message:$("#host-invite-fld-greeting").val().replace(/\n/g,"<br/>")};$.ajax({url:"/services/Invite/send",data:$.param(a),type:"POST",cache:false,dataType:"json",success:function(b){host_screening.finishInvites(b)},error:function(b){console.log("ERROR:",b);error.showError("notice","communication error","Please try again");$("#inviting-popup").delay(2000).fadeOut(400)}})},finishInvites:function(b){if(b.result=="success"){var a=$("#host_invite_count").val();$("#host_invite_count").val(parseInt(a)+parseInt($("#host-accepted-invites-container li").length));$("#host-accepted-invites-container li").remove();error.showError("notice",b.message);$("#inviting-popup").delay(2000).fadeOut(400)}else{error.showError("error",b.message);$("#inviting-popup").delay(2000).fadeOut(400)}},goPaypal:function(){if(($("#screening").html()!="")&&($("#film").html()!="")){var a=$("#host_ticket_price").val();var b=a.replace(".","_");window.location.href="/services/Paypal/express/host?vars="+$("#screening").html()+"-"+$("#film").html()+"-"+b}},pay:function(){$("#host_purchase").fadeIn("slow");$("#host_purchase_submit").click(function(){if(host_screening.validatePurchase()){host_screening.purchaseSubmitted=true;newScreening($("#host_purchase_form"),"/host/"+$("#film").html()+"/purchase/"+$("#screening").html(),host_screening.purchaseResult,"purchase")}})},validatePurchase:function(){console.log("Purchase Here");var b=0;if($("#host-fld-cc_first_name").val()==""){$("#host-fld-cc_first_name").css("background","#ff6666");b++}else{$("#host-fld-cc_first_name").css("background","#A5D0ED")}if($("#host-fld-cc_last_name").val()==""){$("#host-fld-cc_last_name").css("background","#ff6666");b++}else{$("#host-fld-cc_last_name").css("background","#A5D0ED")}if(!host_screening.isValidEmailAddress($("#host-fld-cc_email").val())){$("#host-fld-cc_email").css("background","#ff6666");b++}else{$("#host-fld-cc_email").css("background","#A5D0ED")}if(!host_screening.isValidEmailAddress($("#host-fld-cc_confirm_email").val())){$("#host-fld-cc_confirm_email").css("background","#ff6666");b++}else{$("#host-fld-cc_confirm_email").css("background","#A5D0ED")}if(host_screening.isValidEmailAddress($("#host-fld-cc_email").val())&&host_screening.isValidEmailAddress($("#host-fld-cc_confirm_email").val())){if($("#host-fld-cc_email").val()!=$("#host-fld-cc_confirm_email").val()){$("#host-fld-cc_email").css("background","#ff6666");$("#host-fld-cc_confirm_email").css("background","#ff6666");b++}else{$("#host-fld-cc_email").css("background","#A5D0ED");$("#host-fld-cc_confirm_email").css("background","#A5D0ED")}}if($("#host-fld-cc_number").val()==""){$("#host-fld-cc_number").css("background","#ff6666");b++}else{$("#host-fld-cc_number").css("background","#A5D0ED")}if($("#host-fld-cc_security_number").val()==""){$("#host-fld-cc_security_number").css("background","#ff6666");b++}else{$("#host-fld-cc_security_number").css("background","#A5D0ED")}if($("#host-fld-cc_address1").val()==""){$("#host-fld-cc_address1").css("background","#ff6666");b++}else{$("#host-fld-cc_address1").css("background","#A5D0ED")}if($("#host-fld-cc_city").val()==""){$("#host-fld-cc_city").css("background","#ff6666");b++}else{$("#host-fld-cc_city").css("background","#A5D0ED")}if($("#host-fld-cc_zip").val()==""){$("#host-fld-cc_zip").css("background","#ff6666");b++}else{$("#host-fld-cc_zip").css("background","#A5D0ED")}if(b>0){var a=$("#ticket_price").val();console.log("price: "+a);if(a==0){error.showError("error","Please complete the required fields.")}else{error.showError("error","Your payment information is invalid.")}host_screening.purchaseSubmitted=false;return false}if(host_screening.purchaseSubmitted){error.showError("error","You payment is being processed.");return false}return true},purchaseResult:function(response){console.log("CONFIRMED!");$("#process").fadeOut();var response=eval("("+response+")");if(response.hostResponse.status=="success"){$("#screening").html(response.hostResponse.screening);$("#purchase_result").html(response.hostResponse.result);$("#host_invite_count").val(0);host_screening.confirm()}else{error.showError("error",response.hostResponse.message);host_screening.purchaseSubmitted=false;host_screening.pay()}},confirm:function(){console.log("CONFIRM");$("#host_screening_full_link").html("http://"+$("#domain").html()+"/theater/"+$("#screening").html());$("#host_screening_link").attr("href","/theater/"+$("#screening").html());$("#host_screening_link").click(function(a){a.preventDefault();window.location.href="/theater/"+$("#screening").html()});host_screening.hostSubmitted=false;host_screening.purchaseSubmitted=false;$("#host_purchase").fadeOut("slow").queue(function(){$("#host_confirm").fadeIn("slow");$("#host_purchase").clearQueue()})},isValidEmailAddress:function(b){var a=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return a.test(b)}};$(document).ready(function(){if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(){}}host_screening.init()});var reviews={currentPosition:0,slideWidth:650,slides:$(".slide"),numberOfSlides:0,timeout:10000,init:function(){if($("#slideshow #slidesContainer .slide").length>0){reviews.slideWidth=parseInt($("#slideshow #slidesContainer .slide").css("width").replace("px",""))}reviews.numberOfSlides=reviews.slides.length;if(reviews.numberOfSlides==0){return}$("#slidesContainer").css("overflow","hidden");reviews.slides.wrapAll('<div id="slideInner"></div>').css({"float":"left",width:reviews.slideWidth});$("#slideInner").css("width",reviews.slideWidth*reviews.numberOfSlides);window.setTimeout(reviews.moveSlideRight,reviews.timeout)},moveSlideRight:function(){console.log("Current position: "+reviews.currentPosition);console.log("Number of slides: "+reviews.numberOfSlides);reviews.currentPosition=(reviews.currentPosition==(reviews.numberOfSlides-1))?0:reviews.currentPosition+1;console.log("New position: "+reviews.currentPosition);$("#slideInner").animate({marginLeft:reviews.slideWidth*(-reviews.currentPosition)});window.setTimeout(reviews.moveSlideRight,reviews.timeout)}};$(document).ready(function(){if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(){}}reviews.init()});jQuery.fn.FeedbackFormToDict=function(){var a=this.serializeArray();var c={};for(var b=0;b<a.length;b++){c[a[b].name]=a[b].value}if(c.next){delete c.next}return c};var feedback={init:function(){console.log("Feedback Cookie Is "+$.cookie("csfeedback"));if($.cookie("csfeedback")==undefined){$.cookie("csfeedback",-1,{path:"/",expires:365});feedback.surveyAsk()}},surveyAsk:function(){var a='Can you help us make Constellation.tv better by answering a few brief questions?<br /><br /><a class="btn_med" href="javascript:void(0)" onclick="feedback.addTab()" style="padding-top: 15px !important; margin-right: 15px;">Yes, I\'d love to!</a><a class="btn_med" href="javascript:void(0)" onclick="feedback.dropTab()" style="padding-top: 15px !important;">No Thanks!</a>';error.showError("error","We'd love some feedback!",a,0)},addTab:function(a){$.unblockUI();feedback.getFeedback()},dropTab:function(a){$.cookie("csfeedback",-1,{path:"/",expires:365});$.unblockUI()},showTab:function(){console.log("Showin' the tab...");var a='<a style="background-color:#222" class="fdbk_tab_left" id="fdbk_tab" href="javascript: void(0)">FEEDBACK</a>';$("body").append(a);$("#fdbk_tab").click(function(b){feedback.getFeedback()})},getFeedback:function(){$("#feedback_popup").fadeIn();$("#feedback").click(function(b){var a=$("#feedback_form").FeedbackFormToDict();$.ajax({url:"/services/UserFeedback",data:$.param(a),dataType:"text",type:"POST",success:function(c){feedback.giveThanks()},error:function(c){console.log("ERROR:",c)}})})},giveThanks:function(){$.cookie("csfeedback",-1,{path:"/",expires:365});var a='<div class="clearfix description">Thank you!</div>';$("#feedbody").html(a);$("#feedback_popup").delay(3000).fadeOut()}};$(document).ready(function(){if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(){}}feedback.showTab();feedback.init()});